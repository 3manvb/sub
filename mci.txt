#!/bin/bash

# تنظیم متغیرهای مورد نیاز
GITHUB_USERNAME="3manvb"
GITHUB_REPO="sub"
GITHUB_TOKEN="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"
FILE_PATH="mci.txt"
SOURCE_URL="https://3manvb.s3.ir-thr-at1.arvanstorage.ir/mci.txt"

# دانلود محتویات فایل از آدرس اول
content=$(curl -s $SOURCE_URL)

# تبدیل محتویات فایل به فرمت base64
encoded_content=$(echo -n "$content" | base64)

# ایجاد JSON برای درخواست API
json=$(cat <<EOF
{
  "message": "update file",
  "committer": {
    "name": "$GITHUB_USERNAME",
    "email": "youremail@example.com"
  },
  "content": "$encoded_content"
}
EOF
)

# ارسال درخواست به API گیت‌هاب برای ایجاد یا به‌روزرسانی فایل
curl -X PUT -H "Authorization: token $GITHUB_TOKEN" \
     -d "$json" \
     https://api.github.com/repos/$GITHUB_USERNAME/$GITHUB_REPO/contents/$FILE_PATH
